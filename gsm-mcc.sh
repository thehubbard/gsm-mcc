#!/bin/bash
############################################################
# Help                                                     #
############################################################
Help()
{
    # Display Help
    echo "Change gnone-system-monitor multi-cpu-colours for high multi-cpu/threads e.g. AMD Threadripper."
    echo
    echo "Syntax: gsm-mcc [-h|r]"
    echo "Options:"
    echo "h     Print this Help."
    echo "r     Resets to default colour scheme."
    echo "n     Manually set number of cpu/threads."
    echo
}

############################################################
# Reset                                                    #
############################################################
Reset()
{
    gsettings set org.gnome.gnome-system-monitor cpu-colors "[(uint32 0, '#e6194B'), (1, '#f58231'), (2, '#ffe119'), (3, '#bfef45'), (4, '#3cb44b'), (5, '#42d4f4'), (6, '#4363d8'), (7, '#911eb4'), (8, '#f032e6'), (9, '#fabebe'), (10, '#ffd8b1'), (11, '#fffac8'), (12, '#aaffc3'), (13, '#469990'), (14, '#000075'), (15, '#e6beff'), (16, '#f25915e815e8'), (17, '#f25915e815e8'), (18, '#f25915e815e8'), (19, '#f25915e815e8'), (20, '#f25915e815e8'), (21, '#f25915e815e8'), (22, '#f25915e815e8'), (23, '#f25915e815e8'), (24, '#f25915e815e8'), (25, '#f25915e815e8'), (26, '#f25915e815e8'), (27, '#f25915e815e8'), (28, '#f25915e815e8'), (29, '#f25915e815e8'), (30, '#f25915e815e8'), (31, '#f25915e815e8'), (32, '#f25915e815e8'), (33, '#f25915e815e8'), (34, '#f25915e815e8'), (35, '#f25915e815e8'), (36, '#f25915e815e8'), (37, '#f25915e815e8'), (38, '#f25915e815e8'), (39, '#f25915e815e8'), (40, '#f25915e815e8'), (41, '#f25915e815e8'), (42, '#f25915e815e8'), (43, '#f25915e815e8'), (44, '#f25915e815e8'), (45, '#f25915e815e8'), (46, '#f25915e815e8'), (47, '#f25915e815e8'), (48, '#f25915e815e8'), (49, '#f25915e815e8'), (50, '#f25915e815e8'), (51, '#f25915e815e8'), (52, '#f25915e815e8'), (53, '#f25915e815e8'), (54, '#f25915e815e8'), (55, '#f25915e815e8'), (56, '#f25915e815e8'), (57, '#f25915e815e8'), (58, '#f25915e815e8'), (59, '#f25915e815e8'), (60, '#f25915e815e8'), (61, '#f25915e815e8'), (62, '#f25915e815e8'), (63, '#f25915e815e8')]"
}

############################################################
# Main                                                     #
############################################################

while getopts ":hrn:" option; do
    case $option in
        h) # display Help
            Help
            exit;;
        r) # resets to default
            Reset
            exit;;
        n) # Sets number of cpu/threads manually
            nThread=$OPTARG;;
        \?) # Invalid option
            echo "Error: Invalid option"
            exit;;
    esac
done

if [ -z "$nThread" ]
then
    nThread=`cat /proc/cpuinfo | grep processor | wc -l`
fi

if (( "$nThread" <= 64));
    gsettings set org.gnome.gnome-system-monitor cpu-colors "[(uint32 0, '#97003c'), (1, '#01be52'), (2, '#523dc5'), (3, '#80dc50'), (4, '#a96eff'), (5, '#66a300'), (6, '#da63ee'), (7, '#b6d24b'), (8, '#0270f6'), (9, '#ffb207'), (10, '#0149bb'), (11, '#ff0000'), (12, '#6d7dff'), (13, '#ffff00'), (14, '#620286'), (15, '#4e7e00'), (16, '#f351d4'), (17, '#019770'), (18, '#eb0192'), (19, '#68dab7'), (20, '#e90a42'), (21, '#2ac9ff'), (22, '#f66918'), (23, '#15a2ff'), (24, '#cd7b00'), (25, '#7e93ff'), (26, '#dec554'), (27, '#003c8d'), (28, '#ffb14f'), (29, '#de87ff'), (30, '#004617'), (31, '#ff4cb9'), (32, '#00a39f'), (33, '#e3272c'), (34, '#0190c2'), (35, '#b5000b'), (36, '#006d7e'), (37, '#e4005c'), (38, '#c3cc88'), (39, '#ae0088'), (40, '#8b7500'), (41, '#611d65'), (42, '#f5bb83'), (43, '#014f88'), (44, '#ff5f52'), (45, '#153e5d'), (46, '#ff467b'), (47, '#603b00'), (48, '#ff92d9'), (49, '#8d5c00'), (50, '#cfbef2'), (51, '#a03c00'), (52, '#730257'), (53, '#ffa886'), (54, '#711a22'), (55, '#000000'), (56, '#792b00'), (57, '#ff92ae'), (58, '#5b3015'), (59, '#ff747c'), (60, '#653836'), (61, '#ff9f99'), (62, '#ad0034'), (63, '#915f6b')]"
else
    echo "$nThread threads is not yet implemented. Max is 64"
fi
